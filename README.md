класс MatrixFunc является примером разреженного (sparse) класса для хранения матриц, поскольку он экономно хранит только ненулевые элементы на диагоналях матрицы, игнорируя нулевые значения, которые занимают значительное место в памяти в традиционном подходе.

Объяснение концепции:
Разреженная матрица — это матрица, в которой большая часть элементов равна нулю. Для таких матриц целесообразно использовать специальные структуры данных, которые хранят только ненулевые значения, чтобы экономить память и ускорить операции.

Экономное представление:

В обычной полной матрице (Matrix) каждый элемент хранится независимо, даже если он равен нулю.
В MatrixFunc хранятся только ненулевые элементы, распределенные по диагоналям, что существенно сокращает использование памяти.
Преимущества разреженного хранения:
Экономия памяти: Вместо хранения полного массива элементов (включая нули) хранится только минимальный набор ненулевых элементов.
Ускорение операций: Операции над матрицами (например, сложение или умножение) могут выполняться быстрее, так как обрабатываются только ненулевые элементы.
Преобразование форматов: В данном случае мы можем легко преобразовать полную матрицу в разреженный формат и наоборот.
Пояснение к коду:
Класс Matrix хранит матрицу полностью, занимая память пропорционально числу строк и столбцов (O(n×m)).
Класс MatrixFunc хранит только ненулевые диагонали в виде std::map<int, std::vector<int>>, где:
int — индекс диагонали (например, главная диагональ — 0, верхняя диагональ — положительное значение, нижняя — отрицательное).
std::vector<int> — значения элементов на этой диагонали.
Операции доступа к элементам в MatrixFunc более сложные, так как нужно учитывать сдвиги для диагоналей, но это компенсируется уменьшенным объемом памяти.
Виды разреженных матриц:
Матрицы с диагональным представлением (как в данном примере).
Матрицы в формате CSR (Compressed Sparse Row) — используют три массива: значения, индексы строк и указатели на начало каждой строки.
Матрицы в формате COO (Coordinate Format) — хранятся только координаты ненулевых элементов и их значения.
Таким образом, MatrixFunc — это частный случай разреженной матрицы, предназначенный для экономного хранения матриц с ненулевыми диагоналями.

Подробное объяснение шагов:
-Получение размеров матрицы:
rows = matrix.GetRows(); — задаем количество строк rows для текущего объекта MatrixFunc, чтобы оно совпадало с числом строк в переданной матрице matrix.
cols = matrix.GetCols(); — аналогично, получаем количество столбцов cols.

-Очистка текущих данных:
diagonals.clear(); — удаляем все текущие данные, чтобы матрица MatrixFunc была пустой перед началом заполнения.

-Проход по всем элементам полной матрицы:
Используются вложенные циклы for для перебора всех строк (i) и всех столбцов (j) полной матрицы.
Цикл for (size_t i = 0; i < rows; ++i) проходит по каждой строке матрицы.
Вложенный цикл for (size_t j = 0; j < cols; ++j) проходит по каждому элементу в строке i (то есть по каждому столбцу j).

-Чтение значения элемента матрицы:
int value = matrix.GetValue(i, j); — считываем значение элемента на позиции (i, j) из полной матрицы matrix.

-Проверка значения:
if (value != 0) — если элемент матрицы ненулевой, то он сохраняется в разреженное представление MatrixFunc. Нулевые элементы игнорируются.

-Вычисление номера диагонали:
int diagonal = static_cast<int>(j) - static_cast<int>(i);

-diagonal — индекс диагонали, на которой находится элемент. Этот индекс показывает, насколько сдвинут текущий элемент относительно главной диагонали:
Главная диагональ матрицы — это диагональ, которая идет от элемента (0, 0) до (n-1, n-1) (если квадратная матрица). Ее индекс равен 0.
Элементы выше главной диагонали (справа от нее) имеют положительные индексы: если j > i, то diagonal > 0.
Элементы ниже главной диагонали (слева от нее) имеют отрицательные индексы: если i > j, то diagonal < 0.

-Сохранение ненулевого значения:
SetDiagonalValue(diagonal, (diagonal >= 0) ? i : j, value);
Метод SetDiagonalValue используется для сохранения значения в экономное представление.

-Параметры:
diagonal — индекс диагонали, на которой находится элемент.

-(diagonal >= 0) ? i : j — определяет индекс элемента в массиве текущей диагонали:
Если диагональ положительная (diagonal >= 0), то индексом будет i.
Если диагональ отрицательная (diagonal < 0), то индексом будет j.
Таким образом, мы корректно сохраняем элемент в соответствующую диагональ.

Пример:
Рассмотрим простую 5×5 матрицу с элементами:

Копировать код
1 0 0 0 9
0 2 0 0 0
0 0 3 0 0
0 0 0 4 0
0 0 0 0 5
Главная диагональ (0) содержит: 1, 2, 3, 4, 5.
Положительная диагональ (+4) содержит: 9.
Все остальные элементы равны нулю и не учитываются.
После преобразования матрица MatrixFunc будет выглядеть следующим образом:

diagonals[0] = {1, 2, 3, 4, 5} — главная диагональ.
diagonals[4] = {9} — диагональ, сдвинутая на 4 столбца вправо.
Итог:
Метод FromMatrix преобразует полную матрицу в разреженное представление MatrixFunc, сохраняя только ненулевые элементы и распределяя их по соответствующим диагоналям, что значительно экономит память при хранении больших разреженных матриц.




